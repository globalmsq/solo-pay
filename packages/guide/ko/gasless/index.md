# Gasless 결제

사용자가 가스비 없이 서명만으로 결제할 수 있습니다.

## 개요

Gasless 결제는 **ERC-2771 메타트랜잭션** 표준을 사용합니다. 사용자는 네이티브 토큰(MATIC, ETH 등) 없이도 ERC-20 토큰으로 결제할 수 있습니다.

::: tip 사용 사례
- 신규 사용자 온보딩 (가스비 없이 첫 결제)
- 더 나은 UX (서명만으로 결제 완료)
- 가스비 변동성 제거
:::

## 일반 결제 vs Gasless 결제

```
일반 결제                          Gasless 결제
──────────────                    ──────────────────

  사용자                              사용자
    │                                   │
    │ TX 전송                           │ 서명만
    │ (가스비 지불)                      │ (가스비 없음)
    ▼                                   ▼
  컨트랙트                           Relayer
                                        │
                                        │ TX 전송
                                        │ (가스비 대납)
                                        ▼
                                    컨트랙트
```

## 구성 요소

### 1. EIP-712 서명

사용자 지갑에서 생성하는 타입화된 서명입니다.

- 도메인, 타입, 메시지가 명확히 표시됨
- 사용자가 서명 내용을 확인 가능
- 리플레이 공격 방지

### 2. ERC2771 Forwarder

OpenZeppelin의 `ERC2771Forwarder` 컨트랙트입니다.

- 서명 검증
- 원본 발신자(`_msgSender()`) 복원
- PaymentGateway에 호출 전달

### 3. Relayer

서명된 요청을 받아 온체인 트랜잭션으로 변환합니다.

- 서명 검증
- 가스비 대납
- 트랜잭션 전송 및 모니터링

## Relay 상태 흐름

```
submitted ────▶ pending ────▶ mined ────▶ confirmed
                   │
                   ▼
                failed
```

| 상태 | 설명 |
|------|------|
| `submitted` | Relay 요청이 제출됨 |
| `pending` | 트랜잭션 대기 중 |
| `mined` | 트랜잭션이 블록에 포함됨 |
| `confirmed` | 블록 확정 완료 |
| `failed` | 트랜잭션 실패 |

## 제한 사항

- 토큰 approve가 미리 되어 있어야 함
- Relayer 서비스 가용성에 의존
- 일부 체인에서만 지원

## 지원 체인

| 체인 | Forwarder 주소 | 지원 |
|------|----------------|------|
| Polygon | `0x...` | ✓ |
| Polygon Amoy | `0x...` | ✓ |
| Ethereum | `0x...` | ✓ |
| Sepolia | `0x...` | ✓ |

## 다음 단계

- [구현 방법](/ko/gasless/implementation) - 상세 구현 가이드
